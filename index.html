<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aryan Kahar - Creative Developer & Editor</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { 'display': ['Impact', 'Arial Black', 'sans-serif'], 'sans': ['Inter', 'sans-serif'] },
                    colors: { 'dark-bg': '#111111', 'light-bg': '#F5F5F5', 'dark-text': '#E0E0E0', 'light-text': '#1a1a1a', 'accent-red': '#FF2D2D', 'accent-pink': '#FF3366' },
                },
            },
        };
    </script>
    
    <style>
        body { background-color: #111111; font-family: 'sans', sans-serif; overflow-x: hidden; overflow-y: scroll; cursor: none; }
        html { transition: background-color 0.5s ease; }
        #bg-canvas { position: fixed; top: 0; left: 0; outline: none; z-index: 0; }
        main { position: relative; z-index: 1; }
        .hero-text { font-family: 'display', sans-serif; font-size: clamp(3rem, 15vw, 10rem); line-height: 0.8; text-transform: uppercase; letter-spacing: -0.05em; text-shadow: 0 0 25px rgba(255, 45, 45, 0.5); }
        .section-title { font-family: 'display', sans-serif; font-size: clamp(4rem, 20vw, 12rem); text-transform: uppercase; }
        .grid-background { background-image: linear-gradient(to right, theme('colors.gray.800') 1px, transparent 1px), linear-gradient(to bottom, theme('colors.gray.800') 1px, transparent 1px); background-size: 40px 40px; }
        .light .grid-background { background-image: linear-gradient(to right, theme('colors.gray.300') 1px, transparent 1px), linear-gradient(to bottom, theme('colors.gray.300') 1px, transparent 1px); }
        #preloader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #111; display: flex; justify-content: center; align-items: center; z-index: 1000; transition: opacity 0.5s ease; }
        .loader-bar { width: 50px; height: 3px; background: #fff; animation: pulse 1s infinite ease-in-out; }
        @keyframes pulse { 0% { transform: scaleX(1); } 50% { transform: scaleX(2.5); } 100% { transform: scaleX(1); } }
        nav { background: rgba(17, 17, 17, 0.5); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
        .light nav { background: rgba(245, 245, 245, 0.5); border-bottom: 1px solid rgba(0, 0, 0, 0.1); }
        /* Custom Cursor */
        #cursor-dot, #cursor-outline { position: fixed; top: 0; left: 0; pointer-events: none; z-index: 9999; border-radius: 50%; transition: transform 0.2s, opacity 0.2s; }
        #cursor-dot { width: 6px; height: 6px; background-color: #FF2D2D; transform: translate(-50%, -50%); }
        #cursor-outline { width: 30px; height: 30px; border: 1px solid #FF2D2D; transform: translate(-50%, -50%); transition-duration: 0.4s; }
        .cursor-hovered #cursor-outline { transform: translate(-50%, -50%) scale(2); opacity: 0.5; }
        /* Physics Icons */
        #physics-container { position: relative; width: 100%; height: 400px; margin-top: 2rem; }
        .skill-icon { position: absolute; width: 64px; height: 64px; border-radius: 50%; background-size: 60%; background-position: center; background-repeat: no-repeat; will-change: transform; user-select: none; }
    </style>
</head>
<body class="bg-dark-bg text-dark-text">

    <div id="preloader"><div class="loader-bar"></div></div>
    <div id="cursor-dot"></div>
    <div id="cursor-outline"></div>
    <canvas id="bg-canvas"></canvas>

    <main>
        <nav class="fixed top-0 left-0 w-full p-4 flex justify-between items-center z-50 text-xs sm:text-sm">
            <div class="font-bold text-lg tracking-widest">A</div>
            <div class="hidden sm:flex space-x-6 uppercase">
                <a href="#about-section" class="nav-link hover:text-accent-red transition-colors">About</a>
                <a href="#skills-section" class="nav-link hover:text-accent-red transition-colors">Skills</a>
                <a href="#portfolio-section" class="nav-link hover:text-accent-red transition-colors">Work</a>
                <a href="#contact-section" class="nav-link hover:text-accent-red transition-colors">Contact</a>
            </div>
            <div class="flex items-center space-x-4">
                <button id="theme-toggle" class="w-6 h-6 rounded-full border border-current flex items-center justify-center">
                    <span class="dark:opacity-100 opacity-0">☾</span>
                    <span class="dark:opacity-0 opacity-100">☼</span>
                </button>
            </div>
        </nav>
        
        <section id="hero-section" class="h-screen w-full flex flex-col justify-center items-center text-center p-4">
            <h1 class="hero-text text-red-500">
                <span class="bg-clip-text text-transparent bg-gradient-to-br from-accent-red to-accent-pink">
                    Creative + Developer
                </span>
            </h1>
        </section>

        <section id="about-section" class="w-full py-24 sm:py-32 px-6 sm:px-12 grid-background">
            <div class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-5 gap-12 items-center">
                <div class="md:col-span-2">
                     <p class="about-content text-2xl sm:text-4xl font-display uppercase tracking-tight">I bring visions to life with cinematic edits and interactive code.</p>
                </div>
                <div class="md:col-span-3">
                    <p class="about-content text-base sm:text-lg text-dark-text/80 dark:text-dark-text/70 leading-relaxed">I’m Aryan—a creative hybrid who blends storytelling, clean design, and fast technology. From thumb-stopping video edits to sleek, high-performance websites, I build digital experiences that capture attention and drive results.</p>
                </div>
            </div>
        </section>

        <!-- NEW: Physics-based Skills Section -->
        <section id="skills-section" class="w-full py-24 sm:py-32 px-6 sm:px-12">
            <div class="max-w-4xl mx-auto text-center">
                <h2 class="section-title opacity-10 dark:opacity-5">SKILLS</h2>
                <p class="mt-[-2rem] mb-8 text-dark-text/80 dark:text-dark-text/70">A playground of my favorite tools. Go ahead, push them around.</p>
                <div id="physics-container" class="border border-gray-300/20 dark:border-gray-800/50 rounded-lg">
                    <!-- Icons will be added here by JavaScript -->
                </div>
            </div>
        </section>
        
        <section id="portfolio-section" class="w-full min-h-screen py-24 sm:py-32 px-6 sm:px-12 grid-background">
             <div class="max-w-7xl mx-auto">
                <div id="work-title-placeholder" class="h-48 flex justify-center items-center"></div>
             </div>
        </section>

        <section id="contact-section" class="min-h-[70vh] w-full py-24 sm:py-32 px-6 sm:px-12 flex items-center justify-center">
             <div class="text-center max-w-2xl mx-auto">
                 <h2 class="font-display text-4xl sm:text-6xl uppercase">Let's Build Something</h2>
                 <p class="mt-4 text-dark-text/80 dark:text-dark-text/70">Have a project in mind? Let's talk about your video, design, or website needs.</p>
                 <a href="mailto:hi@aryankahar.com" class="mt-8 inline-block bg-accent-red text-white py-3 px-8 rounded-lg font-bold uppercase tracking-wider hover:bg-accent-pink transition-transform hover:scale-105">
                    Get In Touch
                 </a>
             </div>
        </section>
    </main>

    <script async src="https://unpkg.com/es-module-shims@1.10.0/dist/es-module-shims.js"></script>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.157.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.157.0/examples/jsm/",
                "gsap": "https://unpkg.com/gsap@3.12.5/index.js",
                "gsap/ScrollTrigger": "https://unpkg.com/gsap@3.12.5/ScrollTrigger.js"
            }
        }
    </script>

    <script src="https://unpkg.com/matter-js@0.19.0/build/matter.min.js"></script>

    <script type="module">
        import * as THREE from 'three';
        import { FontLoader } from 'three/addons/loaders/FontLoader.js';
        import { TextGeometry } from 'three/addons/geometries/TextGeometry.js';
        import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
        import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
        import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';
        import { gsap } from "gsap";
        import { ScrollTrigger } from "gsap/ScrollTrigger";

        gsap.registerPlugin(ScrollTrigger);
        
        const portfolioProjects = [
            { title: "Streetwear Ad", image: "https://placehold.co/600x400/000000/ffffff?text=Video+1" },
            { title: "Event Aftermovie", image: "https://placehold.co/600x400/111111/ffffff?text=Video+2" },
            { title: "AlienX Portfolio", image: "https://placehold.co/600x400/222222/ffffff?text=Web+1" },
            { title: "Shivanta Events Logo", image: "https://placehold.co/600x400/333333/ffffff?text=Design+1" },
            { title: "Creator Reel", image: "https://placehold.co/600x400/444444/ffffff?text=Video+3" },
            { title: "Tech Fest Poster", image: "https://placehold.co/600x400/555555/ffffff?text=Design+2" },
        ];
        
        const skillIcons = [
            { id: 'react', url: 'https://cdn.jsdelivr.net/gh/devicons/devicon/icons/react/react-original.svg', name: 'React' },
            { id: 'ae', url: 'https://cdn.jsdelivr.net/gh/devicons/devicon/icons/aftereffects/aftereffects-plain.svg', name: 'After Effects' },
            { id: 'pr', url: 'https://cdn.jsdelivr.net/gh/devicons/devicon/icons/premierepro/premierepro-plain.svg', name: 'Premiere Pro' },
            { id: 'ps', url: 'https://cdn.jsdelivr.net/gh/devicons/devicon/icons/photoshop/photoshop-plain.svg', name: 'Photoshop' },
            { id: 'figma', url: 'https://cdn.jsdelivr.net/gh/devicons/devicon/icons/figma/figma-original.svg', name: 'Figma' },
            { id: 'threejs', url: 'https://cdn.jsdelivr.net/gh/devicons/devicon/icons/threejs/threejs-original.svg', name: 'Three.js' },
        ];
        
        class App {
            constructor() { this.init(); }

            async init() {
                this.setupCursor();
                this.setupThemeToggle();
                this.setupSmoothScrolling();
                await this.setupThreeScene();
                this.setupPhysics();
                this.setupScrollAnimations();
                this.setupEventListeners();
                this.start();
                
                gsap.to('#preloader', { opacity: 0, duration: 0.5, onComplete: () => document.getElementById('preloader').style.display = 'none' });
            }

            setupCursor() {
                this.cursorDot = document.getElementById('cursor-dot');
                this.cursorOutline = document.getElementById('cursor-outline');
                window.addEventListener('mousemove', e => {
                    gsap.to(this.cursorDot, { x: e.clientX, y: e.clientY, duration: 0.2 });
                    gsap.to(this.cursorOutline, { x: e.clientX, y: e.clientY, duration: 0.4 });
                });
                
                document.querySelectorAll('a, button, .skill-icon').forEach(el => {
                    el.addEventListener('mouseenter', () => document.body.classList.add('cursor-hovered'));
                    el.addEventListener('mouseleave', () => document.body.classList.remove('cursor-hovered'));
                });
            }
            
            setupThemeToggle() {
                this.themeToggle = document.getElementById('theme-toggle');
                this.themeToggle.addEventListener('click', () => {
                    const html = document.documentElement;
                    html.classList.toggle('dark');
                    html.classList.toggle('light');
                    this.updateThemeColors(html.classList.contains('dark'));
                });
                
                this.isDarkMode = document.documentElement.classList.contains('dark');
                this.updateThemeColors(this.isDarkMode);
            }
            
            updateThemeColors(isDark) {
                this.isDarkMode = isDark;
                if(this.waveMaterial) {
                     this.waveMaterial.uniforms.uColor1.value.set(isDark ? '#FF2D2D' : '#666666');
                     this.waveMaterial.uniforms.uColor2.value.set(isDark ? '#FF3366' : '#999999');
                }
                if (this.workTextMeshes) {
                    this.workTextMeshes.forEach(mesh => {
                       mesh.material.color.set(isDark ? '#E0E0E0' : '#1a1a1a');
                    });
                }
                 document.body.style.backgroundColor = isDark ? '#111111' : '#F5F5F5';
            }
            
            setupSmoothScrolling() {
                 document.querySelectorAll('.nav-link').forEach(anchor => {
                    anchor.addEventListener('click', function(e) {
                        e.preventDefault();
                        const targetId = this.getAttribute('href');
                        gsap.to(window, { duration: 1, scrollTo: targetId, ease: 'power2.inOut' });
                    });
                });
            }

            async setupThreeScene() {
                this.scene = new THREE.Scene();
                this.camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 100);
                this.renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('bg-canvas'), alpha: true, antialias: true });
                this.renderer.setSize(window.innerWidth, window.innerHeight);
                this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

                this.mouse = new THREE.Vector2(0,0);
                this.targetMouse = new THREE.Vector2(0,0);
                
                this.raycaster = new THREE.Raycaster();
                
                this.pointLight = new THREE.PointLight(0xffffff, 50, 20);
                this.pointLight.position.set(0,0,3);
                this.scene.add(this.pointLight);
                
                // NEW: Post-Processing Setup
                this.composer = new EffectComposer(this.renderer);
                this.composer.addPass(new RenderPass(this.scene, this.camera));
                this.bloomPass = new UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 1.0, 0.1, 0.1);
                this.composer.addPass(this.bloomPass);

                await this.createWavyPlane();
                await this.createWorkText();
                await this.create3DPortfolio();
                
                this.camera.position.set(0, 0, 4);
            }

            async createWavyPlane() {
                 const uniforms = {
                    uTime: { value: 0 },
                    uMouse: { value: new THREE.Vector2(0,0) },
                    uColor1: { value: new THREE.Color(this.isDarkMode ? '#FF2D2D' : '#666666') },
                    uColor2: { value: new THREE.Color(this.isDarkMode ? '#FF3366' : '#999999') },
                };

                this.waveMaterial = new THREE.ShaderMaterial({
                    uniforms,
                    transparent: true,
                    side: THREE.DoubleSide,
                    vertexShader: `
                        varying vec2 vUv;
                        void main() {
                            vUv = uv;
                            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
                        }`,
                    fragmentShader: `
                        uniform float uTime;
                        uniform vec2 uMouse;
                        uniform vec3 uColor1;
                        uniform vec3 uColor2;
                        varying vec2 vUv;
                        
                        // Simplex noise function
                        vec3 mod289(vec3 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
                        vec2 mod289(vec2 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
                        vec3 permute(vec3 x) { return mod289(((x*34.0)+1.0)*x); }
                        float snoise(vec2 v) { const vec4 C = vec4(0.211324865405187, 0.366025403784439,-0.577350269189626, 0.024390243902439); vec2 i  = floor(v + dot(v, C.yy)); vec2 x0 = v -   i + dot(i, C.xx); vec2 i1; i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0); vec4 x12 = x0.xyxy + C.xxzz; x12.xy -= i1; i = mod289(i); vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 )) + i.x + vec3(0.0, i1.x, 1.0 )); vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0); m = m*m; m = m*m; vec3 x = 2.0 * fract(p * C.www) - 1.0; vec3 h = abs(x) - 0.5; vec3 ox = floor(x + 0.5); vec3 a0 = x - ox; m *= (1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h )); vec3 g; g.x  = a0.x  * x0.x  + h.x  * x0.y; g.yz = a0.yz * x12.xw + h.yz * x12.yz; return 130.0 * dot(m, g); }

                        void main() {
                            float noise = snoise(vUv * 3.0 + uTime * 0.1);
                            float lines = fract((vUv.y + noise * 0.1) * 50.0);
                            float intensity = 1.0 - (lines * 1.5);

                            vec3 color = mix(uColor1, uColor2, vUv.y);
                            float alpha = pow(intensity, 2.0);

                            // Add a soft circular fade from center
                            float dist = distance(vUv, vec2(0.5));
                            alpha *= 1.0 - smoothstep(0.4, 0.5, dist);

                            gl_FragColor = vec4(color, alpha);
                        }`
                });

                const planeGeom = new THREE.PlaneGeometry(10, 10, 64, 64);
                this.wavePlane = new THREE.Mesh(planeGeom, this.waveMaterial);
                this.scene.add(this.wavePlane);
            }
            
             async createWorkText() {
                const loader = new FontLoader();
                // A promise wrapper for the loader
                const loadFont = (url) => new Promise(resolve => loader.load(url, resolve));
                const font = await loadFont('https://unpkg.com/three@0.157.0/examples/fonts/helvetiker_bold.typeface.json');
                
                const textGeom = new TextGeometry('WORK', {
                    font: font, size: 1, height: 0.1, curveSegments: 12
                });
                textGeom.center(); // Center the geometry

                this.workTextGroup = new THREE.Group();
                this.workTextMeshes = [];
                const material = new THREE.MeshBasicMaterial({
                    color: this.isDarkMode ? '#E0E0E0' : '#1a1a1a', 
                    transparent: true
                });

                for (let i = 0; i < 15; i++) {
                    const mesh = new THREE.Mesh(textGeom, material);
                    mesh.position.z = -i * 0.1;
                    mesh.scale.setScalar(1 + i * 0.02);
                    this.workTextGroup.add(mesh);
                    this.workTextMeshes.push(mesh);
                }
                
                this.workTextGroup.visible = false; // Hide until scrolled to
                this.scene.add(this.workTextGroup);
            }

            async create3DPortfolio() {
                this.portfolioGroup = new THREE.Group();
                const textureLoader = new THREE.TextureLoader();
                const planeGeom = new THREE.PlaneGeometry(3, 2);

                portfolioProjects.forEach((project, i) => {
                    const texture = textureLoader.load(project.image);
                    const material = new THREE.MeshBasicMaterial({ map: texture });
                    const mesh = new THREE.Mesh(planeGeom, material);
                    
                    const x = (i % 3 - 1) * 3.5;
                    const y = -Math.floor(i / 3) * 2.5;
                    mesh.position.set(x, y, 0);

                    this.portfolioGroup.add(mesh);
                });

                this.portfolioGroup.position.y = -10; // Initial position
                this.scene.add(this.portfolioGroup);
            }
            
            setupPhysics() {
                const container = document.getElementById('physics-container');
                const { width, height } = container.getBoundingClientRect();
                
                const engine = Matter.Engine.create({ gravity: { y: 0 } });
                const runner = Matter.Runner.create();
                
                const wallOptions = { isStatic: true, render: { visible: false } };
                const walls = [
                    Matter.Bodies.rectangle(width / 2, 0, width, 5, wallOptions),
                    Matter.Bodies.rectangle(width / 2, height, width, 5, wallOptions),
                    Matter.Bodies.rectangle(0, height / 2, 5, height, wallOptions),
                    Matter.Bodies.rectangle(width, height / 2, 5, height, wallOptions),
                ];
                Matter.Composite.add(engine.world, walls);

                this.skillBodies = skillIcons.map(icon => {
                    const element = document.createElement('div');
                    element.classList.add('skill-icon');
                    element.style.backgroundImage = `url(${icon.url})`;
                    container.appendChild(element);
                    
                    const body = Matter.Bodies.circle(Math.random() * width, Math.random() * height, 32, {
                         restitution: 0.8, frictionAir: 0.01 
                    });
                    
                    Matter.Body.applyForce(body, body.position, {
                         x: (Math.random() - 0.5) * 0.01,
                         y: (Math.random() - 0.5) * 0.01
                    });
                    
                    return { element, body };
                });
                
                Matter.Composite.add(engine.world, this.skillBodies.map(item => item.body));
                
                // Add mouse control
                const mouse = Matter.Mouse.create(container);
                const mouseConstraint = Matter.MouseConstraint.create(engine, {
                    mouse, constraint: { stiffness: 0.1, render: { visible: false } }
                });
                Matter.Composite.add(engine.world, mouseConstraint);
                
                // Sync loop
                Matter.Events.on(engine, 'afterUpdate', () => {
                    this.skillBodies.forEach(({ element, body }) => {
                        element.style.transform = `translate(${body.position.x - 32}px, ${body.position.y - 32}px) rotate(${body.angle}rad)`;
                    });
                });
                
                Matter.Runner.run(runner, engine);
            }

            setupScrollAnimations() {
                 const tl = gsap.timeline({
                    scrollTrigger: {
                        trigger: 'body',
                        start: 'top top',
                        end: 'bottom bottom',
                        scrub: 1,
                    }
                });

                // Control camera path
                tl.to(this.camera.position, { z: 2.5, y: -2 }, 0)
                  .to(this.camera.position, { z: 4, y: -8, }, 0.5)
                  .to(this.camera.position, { y: -15 }, 1);

                // Animate HTML content sections
                document.querySelectorAll('.about-content').forEach(el => {
                     gsap.from(el, {
                        opacity: 0, y: 50, duration: 1,
                        scrollTrigger: { trigger: '#about-section', start: 'top 70%' }
                    });
                });
                
                // Animate 'WORK' text
                gsap.to(this.workTextGroup.rotation, {
                    y: Math.PI * 0.1,
                    scrollTrigger: {
                         trigger: '#portfolio-section',
                         start: 'top 80%',
                         end: 'bottom top',
                         scrub: true,
                    }
                })
                 gsap.timeline({
                    scrollTrigger: {
                         trigger: '#portfolio-section',
                         start: 'top 60%',
                         onEnter: () => this.workTextGroup.visible = true,
                         onLeaveBack: () => this.workTextGroup.visible = false,
                    }
                 });

                // Animate Portfolio Group
                gsap.to(this.portfolioGroup.position, {
                    y: -10,
                    scrollTrigger: {
                        trigger: '#portfolio-section',
                        start: 'top bottom',
                        end: 'bottom top',
                        scrub: true
                    }
                });
            }
            
            setupEventListeners() {
                 window.addEventListener('resize', this.onResize.bind(this));
                 window.addEventListener('mousemove', this.onMouseMove.bind(this));
            }

            onResize() {
                this.camera.aspect = window.innerWidth / window.innerHeight;
                this.camera.updateProjectionMatrix();
                this.renderer.setSize(window.innerWidth, window.innerHeight);
                this.composer.setSize(window.innerWidth, window.innerHeight);
                this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            }

            onMouseMove(event) {
                 this.targetMouse.x = (event.clientX / window.innerWidth) * 2 - 1;
                 this.targetMouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
            }

            start() {
                const clock = new THREE.Clock();
                const tick = () => {
                    // Smoothly interpolate mouse position for a soft drag effect
                    this.mouse.lerp(this.targetMouse, 0.05);

                    // Update camera based on smoothed mouse
                    this.camera.rotation.y = this.mouse.x * 0.1;
                    this.camera.rotation.x = -this.mouse.y * 0.1;

                    // Update mouse-based light
                    this.pointLight.position.x = this.mouse.x * 5;
                    this.pointLight.position.y = this.mouse.y * 5;

                    // Update wave shader uniforms
                    this.waveMaterial.uniforms.uTime.value = clock.getElapsedTime();
                    this.waveMaterial.uniforms.uMouse.value.set(this.mouse.x, this.mouse.y);
                    
                    // Raycaster for 3D portfolio hover
                    this.raycaster.setFromCamera(this.mouse, this.camera);
                    const intersects = this.raycaster.intersectObjects(this.portfolioGroup.children);

                    this.portfolioGroup.children.forEach(child => {
                         gsap.to(child.scale, { x: 1, y: 1, duration: 0.5, ease: 'power3.out' });
                         gsap.to(child.position, { z: 0, duration: 0.5, ease: 'power3.out' });
                    });

                    if (intersects.length > 0) {
                        const hovered = intersects[0].object;
                        gsap.to(hovered.scale, { x: 1.1, y: 1.1, duration: 0.5, ease: 'power3.out' });
                        gsap.to(hovered.position, { z: 0.5, duration: 0.5, ease: 'power3.out' });
                    }
                    
                    // Update 'WORK' text position based on scroll trigger div
                     if(this.workTextGroup && this.workTextGroup.visible) {
                        const placeholder = document.getElementById('work-title-placeholder');
                        const rect = placeholder.getBoundingClientRect();
                        const worldPos = this.screenToWorld(rect.left + rect.width / 2, rect.top + rect.height / 2);
                        this.workTextGroup.position.lerp(worldPos, 0.1);
                     }
                    
                    // Render using the composer
                    this.composer.render();
                    requestAnimationFrame(tick);
                }
                tick();
            }
            
             // Helper to convert screen pixels to 3D world coordinates
            screenToWorld(x, y) {
                const vec = new THREE.Vector3();
                const pos = new THREE.Vector3();
                vec.set(
                    (x / window.innerWidth) * 2 - 1,
                    -(y / window.innerHeight) * 2 + 1,
                    0.5
                );
                vec.unproject(this.camera);
                vec.sub(this.camera.position).normalize();
                const distance = -this.camera.position.z / vec.z;
                pos.copy(this.camera.position).add(vec.multiplyScalar(distance));
                return pos;
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            new App();
        });
    </script>
</body>
</html>
