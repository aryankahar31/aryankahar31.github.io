<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Universe for Sayali</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;1,700&family=Montserrat:wght@200;400&display=swap" rel="stylesheet">
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Montserrat', sans-serif; touch-action: none; }
        canvas { display: block; cursor: grab; }
        canvas:active { cursor: grabbing; }
        
        #intro-screen {
            position: fixed;
            inset: 0;
            background: radial-gradient(circle at center, #1a0b2e 0%, #000 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            transition: all 1.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .glass-btn {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 182, 193, 0.3);
            color: #ffb6c1;
            padding: 20px 50px;
            border-radius: 100px;
            font-size: 1.2rem;
            cursor: pointer;
            backdrop-filter: blur(15px);
            transition: all 0.5s ease;
            box-shadow: 0 0 30px rgba(255, 182, 193, 0.1);
            letter-spacing: 3px;
            text-transform: uppercase;
        }

        .glass-btn:hover {
            background: rgba(255, 182, 193, 0.2);
            box-shadow: 0 0 50px rgba(255, 182, 193, 0.4);
            transform: translateY(-5px);
        }

        #poetry-overlay {
            position: fixed;
            top: 15%;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            text-align: center;
            z-index: 100;
            pointer-events: none;
            opacity: 0;
            transition: opacity 2s ease;
        }

        .poetic-line {
            font-family: 'Playfair Display', serif;
            font-style: italic;
            color: #fff;
            font-size: 1.8rem;
            text-shadow: 0 0 20px rgba(255, 105, 180, 0.6);
            margin-bottom: 10px;
        }

        #ui-controls {
            position: fixed;
            bottom: 50px;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 40px;
            z-index: 100;
            opacity: 0;
            transition: opacity 2s;
        }

        .nav-arrow {
            color: rgba(255, 255, 255, 0.4);
            cursor: pointer;
            font-size: 2rem;
            transition: color 0.3s;
            pointer-events: auto;
        }

        .nav-arrow:hover { color: #ffb6c1; }

        .zoom-hint {
            position: fixed;
            top: 30px;
            right: 30px;
            color: rgba(255, 255, 255, 0.3);
            font-size: 0.7rem;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
    </style>
</head>
<body>

    <div id="intro-screen">
        <h1 class="text-white text-3xl md:text-5xl font-light mb-12 tracking-widest" style="font-family: 'Playfair Display';">For Sayali</h1>
        <button class="glass-btn" onclick="igniteMagic()">Enter Her Universe</button>
    </div>

    <div class="zoom-hint">Scroll to Zoom • Drag to Rotate</div>

    <div id="poetry-overlay">
        <p id="poetry-text" class="poetic-line">In the silence of the stars, I found your name.</p>
        <p id="shape-indicator" class="text-pink-300 text-xs tracking-[10px] uppercase opacity-50 mt-4">The Eternal Heart</p>
    </div>

    <div id="ui-controls">
        <div class="nav-arrow" onclick="changeShape(-1)">←</div>
        <div class="text-pink-400 text-3xl animate-pulse">❤</div>
        <div class="nav-arrow" onclick="changeShape(1)">→</div>
    </div>

    <script>
        let scene, camera, renderer, particles;
        let pos, targetPos, colors, sizes;
        const COUNT = 22000;
        let currentIndex = 0;
        
        // Interaction State
        let isDragging = false;
        let mouseX = 0, mouseY = 0;
        let targetRotX = 0, targetRotY = 0;
        let zoom = 600;
        let targetZoom = 600;
        let lastTouchDist = 0;

        const UNIVERSE = [
            { id: 'heart', title: 'The Eternal Heart', poem: "You are the beat that my soul follows." },
            { id: 'infinity', title: 'Infinite Devotion', poem: "Beyond time, beyond space, our love exists." },
            { id: 'butterfly', title: 'The Ethereal Grace', poem: "Like a butterfly, you brought color to my world." },
            { id: 'diamond', title: 'The Precious Soul', poem: "Rarer than a star, more brilliant than a diamond." },
            { id: 'sayali_s', title: 'The Celestial Signature', poem: "Written in the heavens, for you alone." },
            { id: 'nebula', title: 'The Cosmic Dream', poem: "In a galaxy of billions, it was always you." }
        ];

        function init() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 1, 4000);
            camera.position.z = 1500; // Start far for entrance

            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            document.body.appendChild(renderer.domElement);

            const geo = new THREE.BufferGeometry();
            pos = new Float32Array(COUNT * 3);
            targetPos = new Float32Array(COUNT * 3);
            colors = new Float32Array(COUNT * 3);
            sizes = new Float32Array(COUNT);

            for (let i = 0; i < COUNT; i++) {
                pos[i*3] = (Math.random() - 0.5) * 4000;
                pos[i*3+1] = (Math.random() - 0.5) * 4000;
                pos[i*3+2] = (Math.random() - 0.5) * 4000;
                sizes[i] = Math.random() * 2 + 0.5;
            }

            geo.setAttribute('position', new THREE.BufferAttribute(pos, 3));
            geo.setAttribute('color', new THREE.BufferAttribute(colors, 3));
            geo.setAttribute('size', new THREE.BufferAttribute(sizes, 1));

            const mat = new THREE.PointsMaterial({
                size: 2.8,
                vertexColors: true,
                transparent: true,
                opacity: 0.85,
                blending: THREE.AdditiveBlending,
                sizeAttenuation: true
            });

            particles = new THREE.Points(geo, mat);
            scene.add(particles);

            // Interaction Listeners
            window.addEventListener('wheel', (e) => {
                targetZoom += e.deltaY * 0.5;
                targetZoom = Math.max(200, Math.min(1200, targetZoom));
            });

            window.addEventListener('mousedown', (e) => { isDragging = true; mouseX = e.clientX; mouseY = e.clientY; });
            window.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                targetRotY += (e.clientX - mouseX) * 0.005;
                targetRotX += (e.clientY - mouseY) * 0.005;
                mouseX = e.clientX; mouseY = e.clientY;
            });
            window.addEventListener('mouseup', () => isDragging = false);

            // Touch Listeners (Pinch & Pan)
            window.addEventListener('touchstart', (e) => {
                isDragging = true;
                if(e.touches.length === 2) {
                    lastTouchDist = Math.hypot(e.touches[0].pageX - e.touches[1].pageX, e.touches[0].pageY - e.touches[1].pageY);
                }
                mouseX = e.touches[0].clientX;
                mouseY = e.touches[0].clientY;
            });

            window.addEventListener('touchmove', (e) => {
                if (!isDragging) return;
                if(e.touches.length === 2) {
                    const dist = Math.hypot(e.touches[0].pageX - e.touches[1].pageX, e.touches[0].pageY - e.touches[1].pageY);
                    targetZoom -= (dist - lastTouchDist) * 2;
                    targetZoom = Math.max(200, Math.min(1200, targetZoom));
                    lastTouchDist = dist;
                } else {
                    targetRotY += (e.touches[0].clientX - mouseX) * 0.008;
                    targetRotX += (e.touches[0].clientY - mouseY) * 0.008;
                    mouseX = e.touches[0].clientX;
                    mouseY = e.touches[0].clientY;
                }
            });
            window.addEventListener('touchend', () => isDragging = false);

            createShape(UNIVERSE[0].id);
            animate();
        }

        function createShape(type) {
            for (let i = 0; i < COUNT; i++) {
                let x, y, z;
                const t = Math.random() * Math.PI * 2;
                const u = Math.random() * Math.PI;

                if (type === 'heart') {
                    const phi = Math.random() * Math.PI * 2;
                    x = 16 * Math.pow(Math.sin(phi), 3);
                    y = 13 * Math.cos(phi) - 5 * Math.cos(2*phi) - 2 * Math.cos(3*phi) - Math.cos(4*phi);
                    z = (Math.random() - 0.5) * 10;
                    const sc = 14; x *= sc; y *= sc; z *= sc;
                } 
                else if (type === 'butterfly') {
                    const phi = (Math.random() * 2 - 1) * Math.PI * 2;
                    const exp = Math.exp(Math.cos(phi)) - 2 * Math.cos(4 * phi) - Math.pow(Math.sin(phi/12), 5);
                    x = Math.sin(phi) * exp * 60;
                    y = Math.cos(phi) * exp * 60;
                    z = (Math.random() - 0.5) * 50;
                }
                else if (type === 'diamond') {
                    const r = 200;
                    if (i < COUNT/2) {
                        const h = Math.random() * r;
                        const ang = Math.random() * Math.PI * 2;
                        const rad = r - h;
                        x = Math.cos(ang) * rad;
                        y = h;
                        z = Math.sin(ang) * rad;
                    } else {
                        const h = -Math.random() * r;
                        const ang = Math.random() * Math.PI * 2;
                        const rad = r + h;
                        x = Math.cos(ang) * rad;
                        y = h;
                        z = Math.sin(ang) * rad;
                    }
                }
                else if (type === 'infinity') {
                    const s = 250;
                    x = (s * Math.cos(t)) / (1 + Math.pow(Math.sin(t), 2));
                    y = (s * Math.sin(t) * Math.cos(t)) / (1 + Math.pow(Math.sin(t), 2));
                    z = (Math.random() - 0.5) * 40;
                } 
                else if (type === 'sayali_s') {
                    const py = (Math.random() - 0.5) * 380;
                    const angle = py * 0.05;
                    x = Math.sin(angle) * 130;
                    y = py;
                    z = Math.cos(angle) * 40;
                    if (y > 0) x = -x;
                } 
                else { // Nebula
                    const r = Math.random() * 500;
                    const sp = r * 0.08;
                    x = Math.cos(t + sp) * r;
                    y = Math.sin(t + sp) * r;
                    z = (Math.random() - 0.5) * 150;
                }

                targetPos[i*3] = x;
                targetPos[i*3+1] = y;
                targetPos[i*3+2] = z;
            }
        }

        function igniteMagic() {
            document.getElementById('intro-screen').style.opacity = '0';
            document.getElementById('intro-screen').style.pointerEvents = 'none';
            document.getElementById('poetry-overlay').style.opacity = '1';
            document.getElementById('ui-controls').style.opacity = '1';
            targetZoom = 600;
            
            setInterval(() => {
                if(!isDragging) changeShape(1);
            }, 10000);
        }

        function changeShape(dir) {
            currentIndex = (currentIndex + dir + UNIVERSE.length) % UNIVERSE.length;
            const item = UNIVERSE[currentIndex];
            
            document.getElementById('poetry-overlay').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('poetry-text').innerText = item.poem;
                document.getElementById('shape-indicator').innerText = item.title;
                document.getElementById('poetry-overlay').style.opacity = '1';
                createShape(item.id);
            }, 1000);
        }

        function animate() {
            requestAnimationFrame(animate);
            const time = Date.now() * 0.0008;
            const p = particles.geometry.attributes.position;
            const c = particles.geometry.attributes.color;

            // Smooth Motion Processing
            camera.position.z += (targetZoom - camera.position.z) * 0.05;
            particles.rotation.y += (targetRotY - particles.rotation.y) * 0.06;
            particles.rotation.x += (targetRotX - particles.rotation.x) * 0.06;

            for (let i = 0; i < COUNT; i++) {
                const ix = i * 3, iy = i * 3 + 1, iz = i * 3 + 2;

                p.array[ix] += (targetPos[ix] - p.array[ix]) * 0.05;
                p.array[iy] += (targetPos[iy] - p.array[iy]) * 0.05;
                p.array[iz] += (targetPos[iz] - p.array[iz]) * 0.05;

                // Stardust breathing effect
                const pulse = Math.sin(time + i * 0.1) * 0.2;
                p.array[ix] += pulse;

                // Romantic Color Gradients
                const h = (0.88 + Math.sin(time * 0.2 + i * 0.0002) * 0.1) % 1;
                const col = new THREE.Color().setHSL(h, 0.9, 0.6);
                c.array[ix] = col.r;
                c.array[iy] = col.g;
                c.array[iz] = col.b;
            }

            p.needsUpdate = true;
            c.needsUpdate = true;
            
            if(!isDragging) targetRotY += 0.0015;

            renderer.render(scene, camera);
        }

        init();
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>

